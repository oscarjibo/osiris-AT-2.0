{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>agrotikos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.10.0/daygrid/main.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f2f4f7;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .navbar {
            background-color: #343a40;
        }

        .navbar-brand {
            color: #fff !important;
        }

        .navbar-nav .nav-link {
            color: #ffffff !important;
        }

        .event-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0px;
            margin-top: 10px;
        }

        .event-card {
            background-color: #fff;
            border: 10px solid #dee2e6;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            margin: 10px;
        }

        .event-card:hover {
            transform: translateY(-5px);
        }

        .event-card .card-body {
            padding: 20px;
            overflow-y: auto;
        }

        .event-card .card-title {
            font-size: 24px;
            margin-bottom: 10px;
            color: #343a40;
        }

        .event-card .card-text {
            color: #6c757d;
        }

        .btn-primary {
            background-color: #007bff;
            border-color: #007bff;
            border-radius: 20px;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .btn-primary:hover {
            background-color: #0056b3;
            border-color: #0056b3;
        }

        #map {
            width: 100%;
            height: 300px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        #calendar {
            width: 100%;
            height: 300px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .fc-day-today {
            background-color: #f00;
            color: white;
        }

        #clima {
            width: 100%;
            height: 380px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        #clima .card-body {
            padding: 20px;
        }

        #clima .card-title {
            font-size: 24px;
            margin-bottom: 10px;
            color: #343a40;
        }

        #clima .card-text {
            color: #6c757d;
        }

        #infoia .card-text {
            color: #ac7000;
        }

        #infoia card-body {
            max-height: 400px;
            overflow-y: auto;
        }

        .lote-label {
            background: transparent;
            border: none;
            box-shadow: none;
            font-weight: bold;
            font-size: 12px;
            color: #333;
            text-align: center;
            text-shadow: 1px 1px 2px white, -1px -1px 2px white;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">agrotikos</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <form action="/inicio" method="post">
                        {% csrf_token %}
                        <button id="btn-monitoreo" type="submit" class="btn btn-primary">Inicio</button>
                    </form>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-5">
        <div class="event-grid">
            <div class="col-md-10">
                <h2 class="text-center mb-4">Asistente Inteligente</h2>
                <div id="infoia" class="card">
                    <div class="card-body">
                        <h5 class="card-title">Recomendaciones</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2"><i class="fa-solid fa-spray-can text-primary me-2"></i>
                                <strong>Fumigación:</strong> Aplicar en Lote B (Sin riesgo de lluvia).
                            </li>
                            <li class="mb-2"><i class="fa-solid fa-cloud-showers-heavy text-info me-2"></i>
                                <strong>Riego:</strong> Suspender riego en Lote Sur por probabilidad de lluvia (76%).
                            </li>
                            <li class="mb-2"><i class="fa-solid fa-magnifying-glass text-warning me-2"></i>
                                <strong>Monitoreo:</strong> Revisar Lote Norte por posibles signos de plagas debido a la
                                humedad reciente.
                            </li>
                            <li class="mb-2"><i class="fa-solid fa-seedling text-success me-2"></i>
                                <strong>Fertilización:</strong> Condiciones óptimas para fertilizar Lote C esta tarde.
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <h2 class="text-center mb-4">Predicción meteorológica</h2>
                <div id="info" class="card">
                    <div class="card-body">
                        <h5 class="card-title"></h5>
                        <div class="row">
                            <div class="col-6 mb-3">
                                <i class="fa-solid fa-cloud-rain text-primary"></i>
                                <strong>Precipitación:</strong><br>15mm (76% prob.)
                            </div>
                            <div class="col-6 mb-3">
                                <i class="fa-solid fa-temperature-high text-danger"></i>
                                <strong>Temperatura:</strong><br>Máx 28°C / Mín 18°C
                            </div>
                            <div class="col-6 mb-3">
                                <i class="fa-solid fa-droplet text-info"></i> <strong>Humedad Rel.:</strong><br>78%
                            </div>
                            <div class="col-6 mb-3">
                                <i class="fa-solid fa-wind text-secondary"></i> <strong>Viento:</strong><br>10 km/h NE
                            </div>
                            <div class="col-6 mb-3">
                                <i class="fa-solid fa-sun text-warning"></i> <strong>Rad. Solar:</strong><br>5.5 kWh/m²
                            </div>
                            <div class="col-6 mb-3">
                                <i class="fa-solid fa-water text-success"></i> <strong>ETo:</strong><br>4.2 mm/día
                            </div>
                            <div class="col-6 mb-3">
                                <i class="fa-solid fa-leaf text-success"></i> <strong>Humedad Hoja:</strong><br>4 horas
                            </div>
                            <div class="col-6 mb-3">
                                <i class="fa-solid fa-layer-group" style="color: #8B4513;"></i> <strong>Humedad
                                    Suelo:</strong><br>25%
                            </div>
                            <div class="col-12">
                                <small class="text-muted"><i class="fa-solid fa-circle-info"></i> Punto de Rocío:
                                    16°C</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <h2 class="text-center mb-4">Blog de Noticias Agrícolas</h2>
                <div class="event-card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fa-solid fa-bug text-danger"></i> Alerta: Plaga en Cundinamarca
                        </h5>
                        <p class="card-text"><small class="text-muted">El Tiempo - Hace 2 horas</small></p>
                        <p class="card-text">Autoridades agrícolas reportan brote de gusano cogollero en cultivos de
                            maíz
                            en municipios de Cundinamarca. Se recomienda monitoreo preventivo.</p>
                    </div>
                </div>
                <div class="event-card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fa-solid fa-cloud-sun-rain text-primary"></i> Pronóstico
                            Semanal</h5>
                        <p class="card-text"><small class="text-muted">IDEAM - Hoy</small></p>
                        <p class="card-text">Se esperan lluvias moderadas en la región Andina durante los próximos 5
                            días.
                            Planifique sus actividades de campo con anticipación.</p>
                    </div>
                </div>
                <div class="event-card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fa-solid fa-chart-line text-success"></i> Precios del Café
                            Suben</h5>
                        <p class="card-text"><small class="text-muted">Portafolio - Ayer</small></p>
                        <p class="card-text">El precio del café arábica aumentó 8% esta semana debido a la alta demanda
                            internacional. Buen momento para comercializar.</p>
                    </div>
                </div>
                <div class="event-card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fa-solid fa-seedling text-warning"></i> Nueva Tecnología
                            Agrícola</h5>
                        <p class="card-text"><small class="text-muted">Agronegocios - Hace 1 día</small></p>
                        <p class="card-text">Ministerio de Agricultura lanza programa de drones para monitoreo de
                            cultivos.
                            Inscripciones abiertas para pequeños productores.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <h2 class="text-center mb-4">Ubicación de tu finca</h2>
                <div id="map" class="card"></div>
            </div>
            <form action="/inicio" method="post" class="d-flex justify-content-center mt-4">
                {% csrf_token %}
                <button id="btn-datos-cultivo" type="submit" class="btn btn-primary">Regresar</button>
            </form>
        </div>

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.10.0/core/main.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.10.0/daygrid/main.min.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                var calendarEl = document.getElementById('calendar');
                var calendar = new FullCalendar.Calendar(calendarEl, {
                    initialView: 'dayGridMonth',
                    locale: 'es',
                    events: [{
                        title: 'Ejemplo de evento 1',
                        start: '2024-04-20'
                    },
                    {
                        title: 'Ejemplo de evento 2',
                        start: '2024-04-25'
                    }
                    ],
                    eventColor: '#ff0000'
                });
                calendar.render();
            });
        </script>

        <script>
            $(function () {
                $("#datepicker").datepicker({
                    dateFormat: 'yy-mm-dd',
                    onSelect: function (date) {
                        alert('Selected date: ' + date);
                    }
                });
            });
        </script>

        <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
        <script>
            var map = L.map('map').setView([2.710989, -74.072090], 14);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
            }).addTo(map);

            L.marker([2.710989, -74.072090]).addTo(map)
                .bindPopup('<b>🏡 Tu Finca</b><br>Acá se ubica tu finca<br><small>Área total: 50 hectáreas</small>')
                .openPopup();

            var loteNorte = L.polygon([
                [2.712800, -74.071800],
                [2.712800, -74.071200],
                [2.712200, -74.071200],
                [2.712200, -74.071800]
            ], { color: 'orange', fillColor: '#FFA500', fillOpacity: 0.4 }).addTo(map);
            loteNorte.bindPopup('<b>🌾 Lote Norte</b><br>' +
                '<b>Recomendación:</b> Revisar por posibles signos de plagas<br>' +
                '<b>Cultivo:</b> Maíz<br>' +
                '<b>Humedad Suelo:</b> 28%<br>' +
                '<b>Temp. Actual:</b> 24°C<br>' +
                '<b>Precipitación hoy:</b> 0mm<br>' +
                '<small>⚠️ Alta humedad reciente favorece plagas</small>');
            loteNorte.bindTooltip("Lote Norte<br>Maíz", { permanent: true, direction: 'center', className: 'lote-label' });

            var loteB = L.polygon([
                [2.712100, -74.073300],
                [2.712100, -74.072700],
                [2.711500, -74.072700],
                [2.711500, -74.073300]
            ], { color: 'blue', fillColor: '#0066FF', fillOpacity: 0.4 }).addTo(map);
            loteB.bindPopup('<b>🌱 Lote B</b><br>' +
                '<b>Recomendación:</b> Aplicar fumigación<br>' +
                '<b>Cultivo:</b> Café<br>' +
                '<b>Humedad Suelo:</b> 22%<br>' +
                '<b>Temp. Actual:</b> 26°C<br>' +
                '<b>Precipitación próx. 24h:</b> 0mm (0%)<br>' +
                '<b>Viento:</b> 8 km/h<br>' +
                '<small>✅ Condiciones ideales para fumigación</small>');
            loteB.bindTooltip("Lote B<br>Café", { permanent: true, direction: 'center', className: 'lote-label' });

            var loteSur = L.polygon([
                [2.709800, -74.072800],
                [2.709800, -74.072200],
                [2.709200, -74.072200],
                [2.709200, -74.072800]
            ], { color: 'cyan', fillColor: '#00CED1', fillOpacity: 0.4 }).addTo(map);
            loteSur.bindPopup('<b>💧 Lote Sur</b><br>' +
                '<b>Recomendación:</b> Suspender riego<br>' +
                '<b>Cultivo:</b> Plátano<br>' +
                '<b>Humedad Suelo:</b> 30%<br>' +
                '<b>Temp. Actual:</b> 25°C<br>' +
                '<b>Precipitación próx. 24h:</b> 15mm (76%)<br>' +
                '<b>Humedad Rel.:</b> 82%<br>' +
                '<small>☔ Lluvia probable - No regar</small>');
            loteSur.bindTooltip("Lote Sur<br>Plátano", { permanent: true, direction: 'center', className: 'lote-label' });

            var loteC = L.polygon([
                [2.710500, -74.071100],
                [2.710500, -74.070500],
                [2.709900, -74.070500],
                [2.709900, -74.071100]
            ], { color: 'green', fillColor: '#32CD32', fillOpacity: 0.4 }).addTo(map);
            loteC.bindPopup('<b>🌿 Lote C</b><br>' +
                '<b>Recomendación:</b> Fertilizar esta tarde<br>' +
                '<b>Cultivo:</b> Aguacate<br>' +
                '<b>Humedad Suelo:</b> 24%<br>' +
                '<b>Temp. Actual:</b> 23°C<br>' +
                '<b>Precipitación próx. 48h:</b> 12mm (60%)<br>' +
                '<b>Radiación Solar:</b> 5.2 kWh/m²<br>' +
                '<small>✅ Óptimo para fertilización</small>');
            loteC.bindTooltip("Lote C<br>Aguacate", { permanent: true, direction: 'center', className: 'lote-label' });
        </script>
</body>

</html>